# Implementation Plan

- [x] 1. Set up project structure and dependencies






  - Create root directory with frontend and backend folders
  - Initialize React TypeScript project with Vite
  - Initialize Flask backend with virtual environment
  - Install frontend dependencies (React, TypeScript, Tailwind CSS, Axios, Socket.IO Client, Wavesurfer.js)
  - Install backend dependencies (Flask, Flask-CORS, Flask-SocketIO, SilentCipher, Librosa)
  - Create .gitignore files for both frontend and backend
  - Set up environment configuration files
  - _Requirements: 10.1, 10.2_

- [x] 2. Implement backend message conversion utilities





  - [x] 2.1 Create MessageConverter class with format conversion methods


    - Implement text_to_numeric() to convert text strings to 5-integer array
    - Implement binary_to_numeric() to convert 40-bit binary string to 5-integer array
    - Implement numeric_to_text() for reverse conversion
    - Implement numeric_to_binary() for reverse conversion
    - Implement validate_message() to validate message formats
    - _Requirements: 2.1, 2.3, 2.4_

  - [x] 2.2 Write unit tests for message conversion

    - Test text to numeric conversion with various inputs
    - Test binary to numeric conversion with edge cases
    - Test validation logic for all formats
    - _Requirements: 2.1, 2.3, 2.4_

- [ ] 3. Implement backend audio processing service
  - [ ] 3.1 Create AudioProcessor class for audio operations
    - Implement load_audio() using librosa
    - Implement save_audio() to write audio files
    - Implement validate_format() to check WAV format and sample rates
    - Implement get_metadata() to extract duration, sample rate, channels
    - _Requirements: 1.1, 1.2_
  - [ ] 3.2 Add distortion methods to AudioProcessor
    - Implement apply_noise() to add Gaussian noise
    - Implement apply_compression() to simulate MP3 compression
    - Implement resample_audio() to change sample rates
    - _Requirements: 5.2, 5.3_
  - [ ] 3.3 Write unit tests for audio processing
    - Test audio loading with valid and invalid files
    - Test metadata extraction accuracy
    - Test distortion application
    - _Requirements: 1.1, 5.2, 5.3_

- [ ] 4. Implement SilentCipher integration service
  - [ ] 4.1 Create SilentCipherService class
    - Implement get_model() to load 16kHz and 44.1kHz models
    - Implement encode_audio() to embed watermarks using SilentCipher
    - Implement decode_audio() to extract watermarks
    - Handle model caching to avoid reloading
    - Calculate and return SDR values
    - _Requirements: 3.1, 3.2, 3.4, 4.1, 4.2_
  - [ ] 4.2 Write integration tests for SilentCipher
    - Test encoding with sample audio files
    - Test decoding accuracy
    - Test with both 16kHz and 44.1kHz audio
    - _Requirements: 3.1, 4.1_

- [ ] 5. Implement Flask API endpoints
  - [ ] 5.1 Create Flask app with CORS configuration
    - Set up Flask application factory
    - Configure CORS for frontend origin
    - Set up file upload limits (50MB)
    - Configure temporary storage directory
    - _Requirements: 10.1, 10.5_
  - [ ] 5.2 Implement /api/encode endpoint
    - Accept audio file and message payload
    - Validate file format and message
    - Call SilentCipherService to encode
    - Return encoded audio with SDR value
    - Handle errors and return appropriate status codes
    - _Requirements: 3.1, 3.2, 3.5, 10.1, 10.3_
  - [ ] 5.3 Implement /api/decode endpoint
    - Accept audio file
    - Call SilentCipherService to decode
    - Return decoded message and confidence scores
    - Handle no-watermark-detected case
    - _Requirements: 4.1, 4.2, 4.3, 4.4, 10.2, 10.3_
  - [ ] 5.4 Implement /api/distort endpoint
    - Accept audio file and distortion parameters
    - Call AudioProcessor to apply distortion
    - Return distorted audio file
    - _Requirements: 5.2, 5.3_
  - [ ] 5.5 Implement /api/providers endpoint
    - Return list of available backend providers
    - Include SilentCipher as default provider
    - _Requirements: 9.1, 9.2_
  - [ ] 5.6 Implement /api/health endpoint
    - Check if SilentCipher models are loaded
    - Return service status
    - _Requirements: 10.5_

- [ ] 6. Implement WebSocket functionality for audio sharing
  - [ ] 6.1 Set up Flask-SocketIO server
    - Initialize Socket.IO with Flask app
    - Configure CORS for WebSocket connections
    - _Requirements: 8.1, 8.2_
  - [ ] 6.2 Create ShareManager service
    - Implement create_share_session() to generate unique share codes
    - Implement get_share_session() to retrieve shared audio
    - Implement cleanup_expired_sessions() with 1-hour timeout
    - Store sessions in memory with expiration tracking
    - _Requirements: 8.2, 8.3_
  - [ ] 6.3 Implement Socket.IO event handlers
    - Handle 'connect' event for client connections
    - Handle 'join_session' to assign device sessions
    - Handle 'share_audio' to create and broadcast share sessions
    - Handle 'request_audio' to retrieve shared audio
    - Handle 'disconnect' for cleanup
    - _Requirements: 8.1, 8.3, 8.5_
  - [ ] 6.4 Write integration tests for WebSocket
    - Test session creation and joining
    - Test audio sharing between mock clients
    - Test session expiration
    - _Requirements: 8.1, 8.3_

- [ ] 7. Implement frontend message input component
  - [ ] 7.1 Create MessageInput component with format switching
    - Create UI with tabs for numeric, text, and binary modes
    - Implement numeric array input with 5 number fields (0-255)
    - Implement text input with character limit
    - Implement binary input with 40-bit validation
    - Add format switching logic
    - _Requirements: 2.1, 2.2, 2.3, 2.4_
  - [ ] 7.2 Add validation and conversion logic
    - Implement validateNumeric() for range checking
    - Implement convertTextToPayload() using backend API or local logic
    - Implement convertBinaryToPayload() for binary string conversion
    - Display validation errors inline
    - _Requirements: 2.5, 2.8_
  - [ ] 7.3 Add random message generation
    - Implement generateRandom() to create random 5-integer array
    - Add button to trigger random generation
    - _Requirements: 2.6_

- [ ] 8. Implement frontend audio upload and player components
  - [ ] 8.1 Create AudioUploader component
    - Create file input with drag-and-drop support
    - Implement validateFile() for format and size checking
    - Implement extractMetadata() using Web Audio API
    - Display file name, duration, and sample rate
    - Show upload errors with helpful messages
    - _Requirements: 1.1, 1.2, 1.4, 1.5_
  - [ ] 8.2 Create AudioPlayer component with waveform
    - Integrate Wavesurfer.js for waveform visualization
    - Implement play/pause controls
    - Implement seek functionality
    - Display current time and duration
    - Add volume control
    - _Requirements: 1.3, 7.2, 7.3_

- [ ] 9. Implement frontend encoder panel
  - [ ] 9.1 Create EncoderPanel component
    - Integrate AudioUploader for original audio
    - Integrate MessageInput for message entry
    - Add "Encode" button with loading state
    - Display encoding progress indicator
    - _Requirements: 3.1, 3.2_
  - [ ] 9.2 Implement encoding API call
    - Create encodeAudio() method using Axios
    - Send audio file and message to /api/encode
    - Handle response with encoded audio blob
    - Handle errors with user-friendly messages
    - _Requirements: 3.1, 10.1, 10.3, 10.4_
  - [ ] 9.3 Display encoding results
    - Show AudioPlayer for encoded audio
    - Display SDR value prominently
    - Add download button for encoded file
    - Show side-by-side comparison with original
    - _Requirements: 3.3, 3.4, 3.5, 7.1, 7.2, 7.4_
  - [ ] 9.4 Add share functionality
    - Add "Share to Device" button
    - Integrate with SharePanel component
    - _Requirements: 8.1_

- [ ] 10. Implement frontend decoder panel
  - [ ] 10.1 Create DecoderPanel component
    - Integrate AudioUploader for watermarked audio
    - Add "Decode" button with loading state
    - Display decoding progress indicator
    - _Requirements: 4.1, 4.5_
  - [ ] 10.2 Implement decoding API call
    - Create decodeAudio() method using Axios
    - Send audio file to /api/decode
    - Handle response with decoded message
    - Handle no-watermark-detected case
    - Handle errors appropriately
    - _Requirements: 4.1, 10.2, 10.3, 10.4_
  - [ ] 10.3 Display decoding results
    - Show decoded message in all formats (numeric, text, binary)
    - Display confidence scores for each value
    - Show detection status clearly
    - Handle and display "no watermark found" state
    - _Requirements: 4.2, 4.3, 4.4_

- [ ] 11. Implement frontend distortion testing panel
  - [ ] 11.1 Create DistortionPanel component with toggle
    - Add checkbox to enable/disable distortion testing
    - Show distortion controls only when enabled
    - Create UI for distortion type selection (noise, compression, resample)
    - Add parameter inputs for each distortion type
    - _Requirements: 5.1, 5.2, 5.7_
  - [ ] 11.2 Implement distortion API call
    - Create applyDistortion() method using Axios
    - Send audio and distortion parameters to /api/distort
    - Handle response with distorted audio blob
    - Handle errors
    - _Requirements: 5.2, 5.3_
  - [ ] 11.3 Display distortion results
    - Show AudioPlayer for distorted audio
    - Add "Decode Distorted" button
    - Display comparison of detection results
    - Show robustness metrics
    - _Requirements: 5.3, 5.4, 5.5, 5.6_

- [ ] 12. Implement frontend audio sharing functionality
  - [ ] 12.1 Create SharePanel component
    - Add "Generate Share Code" button
    - Display generated share code prominently
    - Generate and display QR code using qrcode library
    - Show shareable link
    - _Requirements: 8.1, 8.2_
  - [ ] 12.2 Implement WebSocket client for sharing
    - Initialize Socket.IO client connection
    - Implement generateShareCode() to create unique ID
    - Emit 'share_audio' event with audio blob and metadata
    - Handle connection status and errors
    - _Requirements: 8.1, 8.3_
  - [ ] 12.3 Create ReceivePanel component
    - Add input for entering share code
    - Add "Receive Audio" button
    - Display receiving status
    - _Requirements: 8.3_
  - [ ] 12.4 Implement WebSocket client for receiving
    - Listen for 'audio_shared' events
    - Emit 'request_audio' with share code
    - Handle received audio blob
    - Pass received audio to decoder or player
    - _Requirements: 8.3, 8.4_
  - [ ] 12.5 Display device session identifier
    - Generate unique device session ID on app load
    - Display session ID in UI header or footer
    - Persist session ID in sessionStorage
    - _Requirements: 8.5_

- [ ] 13. Implement backend provider abstraction
  - [ ] 13.1 Create BackendProvider interface
    - Define abstract base class for backend providers
    - Define methods: encode(), decode(), get_capabilities()
    - _Requirements: 9.3_
  - [ ] 13.2 Implement SilentCipherProvider
    - Create concrete implementation of BackendProvider
    - Wrap SilentCipherService methods
    - Return provider metadata (name, features, etc.)
    - _Requirements: 9.2, 9.3_
  - [ ] 13.3 Create ProviderManager
    - Implement provider registration system
    - Implement get_provider() to retrieve active provider
    - Implement list_providers() for /api/providers endpoint
    - _Requirements: 9.1, 9.4_

- [ ] 14. Implement frontend backend selector
  - [ ] 14.1 Create BackendSelector component
    - Fetch available providers from /api/providers
    - Display provider options in dropdown or radio buttons
    - Show provider description and features
    - _Requirements: 9.1, 9.2_
  - [ ] 14.2 Implement provider switching
    - Update global state when provider changes
    - Persist selection in localStorage
    - Update encoder and decoder panels with new provider
    - _Requirements: 9.4, 9.5_

- [ ] 15. Implement main app layout and routing
  - [ ] 15.1 Create App component with global state
    - Set up React Context for global state (backend provider, device session, socket)
    - Initialize Socket.IO connection on mount
    - Generate and store device session ID
    - _Requirements: 8.5, 9.5_
  - [ ] 15.2 Create main layout with Tailwind CSS
    - Design header with app title and BackendSelector
    - Create tabbed or sectioned layout for Encoder, Decoder, and Share panels
    - Add footer with device session ID
    - Implement responsive design
    - _Requirements: 6.1, 6.2, 6.6_
  - [ ] 15.3 Wire up all components
    - Integrate EncoderPanel with share functionality
    - Integrate DecoderPanel with receive functionality
    - Connect DistortionPanel to encoder output
    - Ensure proper data flow between components
    - _Requirements: 6.3, 6.4_

- [ ] 16. Add error handling and user feedback
  - [ ] 16.1 Create ErrorBoundary component
    - Catch React errors and display fallback UI
    - Log errors for debugging
    - _Requirements: 6.4_
  - [ ] 16.2 Implement toast notification system
    - Add toast library (react-hot-toast or similar)
    - Show success messages for completed operations
    - Show error messages with retry options
    - Show info messages for status updates
    - _Requirements: 6.3, 6.4_
  - [ ] 16.3 Add loading states throughout UI
    - Show spinners during API calls
    - Disable buttons during processing
    - Show progress indicators for long operations
    - _Requirements: 3.2, 4.5_

- [ ] 17. Implement file cleanup and resource management
  - [ ] 17.1 Add backend file cleanup service
    - Create cleanup task to remove files older than 1 hour
    - Implement automatic cleanup on server startup
    - Add cleanup on session expiration
    - _Requirements: 8.4_
  - [ ] 17.2 Add frontend memory management
    - Revoke object URLs when components unmount
    - Clear audio blobs when no longer needed
    - Implement cleanup on page unload
    - _Requirements: 7.3_

- [ ] 18. Create configuration and documentation files
  - [ ] 18.1 Create backend configuration
    - Create config.py with environment variables
    - Create requirements.txt with all dependencies
    - Create README.md with setup instructions
    - Add example .env file
    - _Requirements: 10.5_
  - [ ] 18.2 Create frontend configuration
    - Create .env.example with API URL
    - Update package.json with scripts
    - Create README.md with development instructions
    - _Requirements: 10.5_
  - [ ] 18.3 Create root README
    - Document project overview
    - Add setup instructions for both frontend and backend
    - Include usage examples
    - Add screenshots or demo links
    - _Requirements: 6.1, 6.5_

- [ ] 19. Final integration and testing
  - [ ] 19.1 Test complete encoding workflow
    - Upload audio, enter message, encode, play result
    - Verify SDR display and download functionality
    - Test with different audio formats and sample rates
    - _Requirements: 1.1, 2.1, 3.1, 3.3, 3.4, 3.5_
  - [ ] 19.2 Test complete decoding workflow
    - Upload watermarked audio and decode
    - Verify message display and confidence scores
    - Test with non-watermarked audio
    - _Requirements: 4.1, 4.2, 4.3, 4.4_
  - [ ] 19.3 Test distortion workflow
    - Enable distortion testing
    - Apply various distortions
    - Decode distorted audio
    - Verify robustness results
    - _Requirements: 5.1, 5.2, 5.3, 5.4, 5.5, 5.6_
  - [ ] 19.4 Test cross-device sharing
    - Share audio from one device
    - Receive on another device
    - Decode received audio
    - Verify audio integrity
    - _Requirements: 8.1, 8.2, 8.3, 8.4, 8.5_
  - [ ] 19.5 Test backend provider switching
    - Switch between providers (when multiple available)
    - Verify UI updates correctly
    - Test encoding/decoding with different providers
    - _Requirements: 9.1, 9.4, 9.5_
  - [ ] 19.6 Perform end-to-end testing
    - Test all workflows in sequence
    - Test error scenarios
    - Test with various audio files
    - Verify performance and responsiveness
    - _Requirements: 6.1, 6.2, 6.3, 6.4, 6.5, 6.6_
